<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ESP8266 MQTT Control - Mosquitto WSS</title>
<script src="https://unpkg.com/paho-mqtt/mqttws31.min.js"></script>
<style>
    /* ... (CSS giữ nguyên) ... */
</style>
</head>
<body>
<h2>ESP8266 MQTT Control - Mosquitto Chuẩn 443</h2>
<button id="onBtn">ON</button>
<button id="offBtn">OFF</button>

<p id="status">Đang thiết lập kết nối WSS...</p>

<script>
    // ----------------------------------------------------------------
    // CẤU HÌNH SỬ DỤNG MOSQUITTO VỚI CỔNG 443
    // ----------------------------------------------------------------
    const broker = "broker.mosquitto.org"; // THAY ĐỔI
    const port = 443; // Cổng WSS chuẩn HTTPS, LUÔN ĐƯỢC MỞ
    const clientId = "web_" + Math.floor(Math.random() * 1000000);
    const topic = "esp8266/control"; 

    const client = new Paho.MQTT.Client(broker, port, clientId);
    
    // ... (Các định nghĩa biến và hàm giữ nguyên) ...

    // BẮT ĐẦU KẾT NỐI VỚI THAM SỐ useSSL: true VÀ PORT 443
    client.onConnectionLost = onConnectionLost;
    client.connect({
        useSSL: true, // BẮT BUỘC
        onSuccess: onConnect,
        onFailure: onFailure
    });

    onBtn.addEventListener('click', () => sendCommand("ON"));
    offBtn.addEventListener('click', () => sendCommand("OFF"));
</script>
</body>
</html>